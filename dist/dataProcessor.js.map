{"version":3,"sources":["../src/dataProcessor.js"],"names":["scale","factor","datapoints","_","map","point","offset","delta","newSeries","i","length","deltaValue","push","fluctuation","flucValue","transformWrapper","func","args","funcArgs","slice","timeseriesData","tsData","timeseries","exclude","pattern","regex","RegExp","filter","test","target","datapointsAvg","meanBy","datapointsMin","minPoint","minBy","datapointsMax","maxPoint","maxBy","datapointsSum","sumBy","datapointsAbsMin","Math","abs","datapointsAbsMax","datapointsAggFuncs","avg","min","max","sum","absoluteMin","absoluteMax","extraction","order","n","orderFunc","orderByCallback","sortByIteratee","ts","sortedTsData","sortBy","reverse","functions","partial","top","bottom","aaFunctions"],"mappings":"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","sourcesContent":["import _ from 'lodash';\n\n// Transform\n\nfunction scale(factor, datapoints) {\n  return _.map(datapoints, (point) => (\n    [point[0] * factor, point[1]]\n  ));\n}\n\nfunction offset(delta, datapoints) {\n  return _.map(datapoints, (point) => (\n    [point[0] + delta, point[1]]\n  ));\n}\n\nfunction delta(datapoints) {\n  const newSeries = [];\n  for (let i = 1; i < datapoints.length; i += 1) {\n    const deltaValue = datapoints[i][0] - datapoints[i - 1][0];\n    newSeries.push([deltaValue, datapoints[i][1]]);\n  }\n  return newSeries;\n}\n\nfunction fluctuation(datapoints) {\n  const newSeries = [];\n  for (let i = 0; i < datapoints.length; i += 1) {\n    const flucValue = datapoints[i][0] - datapoints[0][0];\n    newSeries.push([flucValue, datapoints[i][1]]);\n  }\n  return newSeries;\n}\n\n// [Support Funcs] Transform wrapper\n\nfunction transformWrapper(func, ...args) {\n  const funcArgs = args.slice(0, -1);\n  const timeseriesData = args[args.length - 1];\n\n  const tsData = _.map(timeseriesData, (timeseries) => {\n    timeseries.datapoints = func(...funcArgs, timeseries.datapoints);\n    return timeseries;\n  });\n\n  return tsData;\n}\n\n// Filter Series\nfunction exclude(pattern, timeseriesData) {\n  const regex = new RegExp(pattern);\n  return _.filter(timeseriesData, (timeseries) => (!regex.test(timeseries.target)));\n}\n\n// [Support Funcs] Datapoints aggregation functions\n\nfunction datapointsAvg(datapoints) {\n  return _.meanBy(datapoints, (point) => point[0]);\n}\n\nfunction datapointsMin(datapoints) {\n  const minPoint = _.minBy(datapoints, (point) => point[0]);\n  return minPoint[0];\n}\n\nfunction datapointsMax(datapoints) {\n  const maxPoint = _.maxBy(datapoints, (point) => point[0]);\n  return maxPoint[0];\n}\n\nfunction datapointsSum(datapoints) {\n  return _.sumBy(datapoints, (point) => point[0]);\n}\n\nfunction datapointsAbsMin(datapoints) {\n  const minPoint = _.minBy(datapoints, (point) => Math.abs(point[0]));\n  return Math.abs(minPoint[0]);\n}\n\nfunction datapointsAbsMax(datapoints) {\n  const maxPoint = _.maxBy(datapoints, (point) => Math.abs(point[0]));\n  return Math.abs(maxPoint[0]);\n}\n\nconst datapointsAggFuncs = {\n  avg: datapointsAvg,\n  min: datapointsMin,\n  max: datapointsMax,\n  sum: datapointsSum,\n  absoluteMin: datapointsAbsMin,\n  absoluteMax: datapointsAbsMax,\n};\n\n// [Support Funcs] Wrapper function for top and bottom function\n\nfunction extraction(order, n, orderFunc, timeseriesData) {\n  const orderByCallback = datapointsAggFuncs[orderFunc];\n  const sortByIteratee = (ts) => (\n    orderByCallback(ts.datapoints)\n  );\n\n  const sortedTsData = _.sortBy(timeseriesData, sortByIteratee);\n  if (order === 'bottom') {\n    return _.slice(sortedTsData, 0, n);\n  }\n\n  return _.reverse(_.slice(sortedTsData, -n));\n}\n\n// Function list\n\nconst functions = {\n  // Transform\n  scale: _.partial(transformWrapper, scale),\n  offset: _.partial(transformWrapper, offset),\n  delta: _.partial(transformWrapper, delta),\n  fluctuation: _.partial(transformWrapper, fluctuation),\n  // Filter Series\n  top: _.partial(extraction, 'top'),\n  bottom: _.partial(extraction, 'bottom'),\n  exclude,\n};\n\nexport default {\n  get aaFunctions() {\n    return functions;\n  },\n};\n"],"file":"dataProcessor.js"}